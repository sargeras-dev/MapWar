window.__require=function t(e,o,n){function r(a,c){if(!o[a]){if(!e[a]){var s=a.split("/");if(s=s[s.length-1],!e[s]){var p="function"==typeof __require&&__require;if(!c&&p)return p(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var l=o[a]={exports:{}};e[a][0].call(l.exports,function(t){return r(e[a][1][t]||t)},l,l.exports,t,e,o,n)}return o[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<n.length;a++)r(n[a]);return r}({BlockHouse:[function(t,e,o){"use strict";cc._RF.push(e,"d2ec8o0yrZPmp9lP1hLKkZM","BlockHouse");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.BlockHouse=void 0;var a=t("./LocalDataManager"),c=t("./PlotItem"),s=t("./Utils"),p=cc._decorator,l=p.ccclass,u=p.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.PersonNum=null,e.AutoEnemyAttackChance=.7,e.AutoEnemyAttackSpeed=10,e.GrowSpeed=1,e._startGrow=!1,e._uniqueAttributeIndex=0,e._currentTime=0,e._autoAttackTime=0,e}return r(e,t),Object.defineProperty(e.prototype,"UniqueAttributeIndex",{get:function(){return this._uniqueAttributeIndex},set:function(t){this._uniqueAttributeIndex=t},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.AutoEnemyAttackSpeed=s.Utils.RandomNum(this.AutoEnemyAttackSpeed/2,this.AutoEnemyAttackSpeed,!0)},e.prototype.AddPerson=function(t){this._currentPerson+=t,this.refreshUI(this._currentPerson)},e.prototype.GetCurrentPerson=function(){return this._currentPerson},e.prototype.SubPerson=function(t,e,o,n){void 0===e&&(e=null),void 0===o&&(o=-1),void 0===n&&(n=!1),this._currentPerson-=t,this._autoAttackTime=0,this._currentTime=0,n?this._currentPerson<0&&(this._currentPerson=0):this._currentPerson=Math.abs(this._currentPerson),this.refreshUI(this._currentPerson),this._currentPerson<=0&&(e&&(this.node.parent.color=e),this.UniqueAttributeIndex=o,this.UniqueAttributeIndex===a.LocalDataManager.Instance.PlayerUniqueAttributeIndex&&this.node.parent.getComponent(c.PlotItem)&&this.node.parent.getComponent(c.PlotItem).SetMyPlayer(),this.StartGrow())},e.prototype.refreshUI=function(t){this.PersonNum.string=parseInt(t.toString()).toString()},e.prototype.SetGrowSpeed=function(t){this.GrowSpeed=t},e.prototype.StopGrowUp=function(){this._startGrow=!1},e.prototype.StartGrow=function(){[1,2].includes(a.LocalDataManager.Instance.CurrentCheckpoint)||(this._startGrow=!0)},e.prototype.InitData=function(t){console.log("personNum: "+t),this._currentPerson=t,this.refreshUI(t),this._startGrow=!1},e.prototype.autoGrowPerson=function(){this._currentPerson<a.LocalDataManager.Instance.GetHighLimitPersonNum()&&(this.UniqueAttributeIndex===a.LocalDataManager.Instance.PlayerUniqueAttributeIndex?this.AddPerson(a.LocalDataManager.Instance.PersonSpeed):this.AddPerson(1))},e.prototype.autoAttack=function(){this.UniqueAttributeIndex!==a.LocalDataManager.Instance.PlayerUniqueAttributeIndex&&(Math.random()<this.AutoEnemyAttackChance?this.node.parent.getComponent(c.PlotItem).AutoAttack(!1):this.node.parent.getComponent(c.PlotItem).AutoAttack(!0))},e.prototype.update=function(t){this._startGrow&&(this._currentTime+=t,this._currentTime>this.GrowSpeed&&(this.autoGrowPerson(),this._currentTime=0),this._autoAttackTime+=t,this._autoAttackTime>this.AutoEnemyAttackSpeed&&(this.autoAttack(),this._autoAttackTime=0))},i([u(cc.Label)],e.prototype,"PersonNum",void 0),i([u],e.prototype,"AutoEnemyAttackChance",void 0),i([u],e.prototype,"AutoEnemyAttackSpeed",void 0),i([u],e.prototype,"GrowSpeed",void 0),i([l],e)}(cc.Component);o.BlockHouse=h,cc._RF.pop()},{"./LocalDataManager":"LocalDataManager","./PlotItem":"PlotItem","./Utils":"Utils"}],ButtleItem:[function(t,e,o){"use strict";cc._RF.push(e,"3a6125MruZAtrFYbgIr5YQS","ButtleItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.ButtleItem=void 0;var a=t("./BlockHouse"),c=cc._decorator,s=c.ccclass,p=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return r(e,t),o=e,e.prototype.SetUniqueAttributeIndex=function(t,e,o){this._uniqueAttributeIndex=t,this._belongUUid=e,this._targetNode=o},e.prototype.GetUniqueAttributteIndex=function(){return this._uniqueAttributeIndex},e.prototype.GetBelongUUId=function(){return this._belongUUid},e.prototype.onCollisionEnter=function(t,e){if(this._targetNode===t.node)console.log("other: "+t.node.name),"BlockHouse"===t.node.name&&(t.node.getComponent(a.BlockHouse).UniqueAttributeIndex!=this._uniqueAttributeIndex?t.node.getComponent(a.BlockHouse).SubPerson(1,this.node.color,this._uniqueAttributeIndex):t.node.getComponent(a.BlockHouse).AddPerson(1)),e.node.destroy();else if("Bullet"===t.node.name){if(this._uniqueAttributeIndex===t.node.getComponent(o).GetUniqueAttributteIndex())return;e.node.destroy()}},o=i([s],e)}(cc.Component));o.ButtleItem=p,cc._RF.pop()},{"./BlockHouse":"BlockHouse"}],Buttle:[function(t,e,o){"use strict";cc._RF.push(e,"f3d06eRLdtAprsJUeDG3FLC","Buttle");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.Buttle=void 0;var a=t("./ButtleItem"),c=cc._decorator,s=c.ccclass,p=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ButtleItems=[],e._closeIng=!1,e}return r(e,t),e.prototype.InitData=function(t,e){for(var o=0;o<this.ButtleItems.length;o++){var n=this.ButtleItems[o];n.node.active=o<t,n.node.color=e}},e.prototype.SetUniqueAttributeIndex=function(t,e,o){for(var n=0,r=this.ButtleItems;n<r.length;n++)r[n].SetUniqueAttributeIndex(t,e,o)},e.prototype.SpreadOutButtle=function(){for(var t=0;t<this.ButtleItems.length;t++){var e=this.ButtleItems[t].node;0!==t&&cc.tween(e).to(.03*t,{position:cc.v3(0,0,0)}).start()}},e.prototype.CloseWithButtle=function(){if(!this._closeIng){this._closeIng=!0;for(var t=[cc.v3(0,2,274),cc.v3(30,3,0),cc.v3(-30,3),cc.v3(59.764,16),cc.v3(-60,11)],e=0;e<this.ButtleItems.length;e++){var o=this.ButtleItems[e].node;cc.tween(o).to(.05*e,{position:t[e]}).start()}}},i([p([a.ButtleItem])],e.prototype,"ButtleItems",void 0),i([s],e)}(cc.Component);o.Buttle=l,cc._RF.pop()},{"./ButtleItem":"ButtleItem"}],GameConst:[function(t,e,o){"use strict";cc._RF.push(e,"0c133OqATpIcaH3WhC2TeB4","GameConst"),Object.defineProperty(o,"__esModule",{value:!0}),o.EnumLocalDataScope=o.EUpdateType=o.EPLAYERDATA=void 0,function(t){t.CurrentCheckpoint="CurrentCheckpoint",t.MainCoin="MainCoin",t.PersonSpeed="PersonSpeed",t.CurrentPersonSpeedLv="CurrentPersonSpeedLv",t.CurrentPersonLv="CurrentPersonLv",t.Shop="Shop",t.CurrentShopXBItemName="CurrentShopXBItemName",t.CurrentShopJDItemName="CurrentShopJDItemName"}(o.EPLAYERDATA||(o.EPLAYERDATA={})),function(t){t[t.Person=0]="Person",t[t.PersonSpeed=1]="PersonSpeed"}(o.EUpdateType||(o.EUpdateType={})),function(t){t[t.Share=0]="Share",t[t.BindUser=1]="BindUser"}(o.EnumLocalDataScope||(o.EnumLocalDataScope={})),cc._RF.pop()},{}],GamePlotMain:[function(t,e,o){"use strict";cc._RF.push(e,"2d179hU1pVNwr6NxOdK9/2N","GamePlotMain");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.GamePlotMain=void 0;var a=t("./GameConst"),c=t("./LocalDataManager"),s=t("./PlotItem"),p=t("./Utils"),l=cc._decorator,u=l.ccclass,h=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.MainCoin=null,e.BGMask=null,e.MainGK=null,e.PersonNum=null,e.PersonNumNeedCoin=null,e.PersonSpeedNum=null,e.PersonSpeedNeedCoin=null,e.GameConfig=null,e.MapContainer=null,e.OpContainer=null,e.GameOpContainer=null,e.BlBtn=null,e.BlSpeedBtn=null,e.GameStartBtn=null,e.SuccessNode=null,e.FaileNode=null,e.Finger1=null,e.Finger2=null,e.BackBtn=null,e.MombPrefab=null,e.MissleBtn=null,e.ArrowPrefab=null,e.Speed=1,e._missleTimerOut=!1,e._missleIsBoomb=!1,e._arrowPrefab=null,e}return r(e,t),e.prototype.onLoad=function(){c.LocalDataManager.Instance.Init();var t=this.GameConfig.json;c.LocalDataManager.Instance.GameGlobalConfig=t,this._gameGlobalConfig=c.LocalDataManager.Instance.GameGlobalConfig,console.log("GameGlobalConfig: "+JSON.stringify(c.LocalDataManager.Instance.GameGlobalConfig)),cc.director.getCollisionManager().enabled=!0,this.MissleBtn.on(cc.Node.EventType.TOUCH_START,this._onTouchStart,this),this.MissleBtn.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.MissleBtn.on(cc.Node.EventType.TOUCH_END,this._onTouchEnd,this),this.MissleBtn.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this)},e.prototype.convertToNodeSpace=function(t,e){var o=e.parent.convertToWorldSpaceAR(e.position);return t.convertToNodeSpaceAR(o)},e.prototype._onTouchCancel=function(t){var e,o=this;if(this._arrowPrefab&&(this._arrowPrefab.destroy(),this._arrowPrefab=null),[1,2].includes(c.LocalDataManager.Instance.CurrentCheckpoint)){if(this._missleIsBoomb)return;var n=t.getLocation(),r=this.CheckTouchRight(n,-1);if(r&&r.parent.getComponent(s.PlotItem)){null===(e=r.parent.getComponent(s.PlotItem))||void 0===e||e.RemoveTargeMark(),console.log("_onTouchMove target name "+r.name);var i=90*Math.atan2(n.sub(cc.v2(this.MissleBtn.position.x,this.MissleBtn.position.y)).y,n.sub(cc.v2(this.MissleBtn.position.x,this.MissleBtn.position.y)).x)/Math.PI,a=cc.instantiate(this.MissleBtn);a.rotation=-i;var l=p.Utils.ConvertToNodeSpace(this.node,r),u=cc.instantiate(this.MombPrefab);this.node.addChild(a);var h=this.MissleBtn.getChildByName("zhakuang");h.active=!0,h.getComponent(cc.Sprite).fillRange=1,a.position=this.MissleBtn.position,cc.tween(a).to(1,{position:l}).call(function(){o.node.addChild(u),a.opacity=0,u.position=l}).delay(1).call(function(){var t,e;u.destroy(),a.destroy();var n=null===(t=r.parent.getComponent(s.PlotItem))||void 0===t?void 0:t.GetBlockHouse().UniqueAttributeIndex;null===(e=r.parent.getComponent(s.PlotItem))||void 0===e||e.GetBlockHouse().SubPerson(50,null,n,!0),o.schedule(function(){h.getComponent(cc.Sprite).fillRange-=.2,h.getComponent(cc.Sprite).fillRange<=.3&&(o._missleIsBoomb=!1)},1,4,0)}).start()}}else this._missleIsBoomb=!1},e.prototype._onTouchEnd=function(){},e.prototype._onTouchMove=function(t){var e;if([1,2].includes(c.LocalDataManager.Instance.CurrentCheckpoint)&&!this._missleIsBoomb){var o=t.getLocation(),n=t.getStartLocation(),r=this.CheckTouchRight(o,-1);null===this._arrowPrefab&&(this._arrowPrefab=cc.instantiate(this.ArrowPrefab),this.MissleBtn.addChild(this._arrowPrefab));var i=o.sub(n).len();this._arrowPrefab.height=i;var a=p.Utils.GetAngle(n.x,n.y,o.x,o.y);this._arrowPrefab.rotation=a,r&&(null===(e=r.parent.getComponent(s.PlotItem))||void 0===e||e.SetTargetMark(),console.log("_onTouchMove target name "+r.name))}},e.prototype._onTouchStart=function(t){t.target,console.log("missle _onTouchStart ...."),this._arrowPrefab&&(this._arrowPrefab.destroy(),this._arrowPrefab=null)},e.prototype.ClearMapBrothersPlot=function(){this._getMapBrothersPlot.length=0},e.prototype.GetMapBrothersPlot=function(){var t,e,o,n;if(this._getMapBrothersPlot.length>0){for(var r=0,i=this._getMapBrothersPlot;r<i.length;r++)null===(t=i[r].parent.getComponent(s.PlotItem))||void 0===t||t.RemoveTargeMark();return this._getMapBrothersPlot}for(var a=c.LocalDataManager.Instance.GetCurrentCheckpointConvertCheckPoint(),p=c.LocalDataManager.Instance.GameGlobalConfig.CheckPointMap,l=0;l<this.MapContainer.childrenCount;l++){var u=this.MapContainer.children[l],h=null===(e=u.getComponent(s.PlotItem))||void 0===e?void 0:e.GetIndex();h!==l&&p.MapHash[a-1].includes(h)&&this._getMapBrothersPlot.push(null===(o=u.getComponent(s.PlotItem))||void 0===o?void 0:o.GetBlockHouseNode())}for(var d=0,f=this._getMapBrothersPlot;d<f.length;d++)null===(n=f[d].getComponent(s.PlotItem))||void 0===n||n.RemoveTargeMark();return this._getMapBrothersPlot},e.prototype.onDestroy=function(){this.MissleBtn.off(cc.Node.EventType.TOUCH_START,this._onTouchStart,this),this.MissleBtn.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.MissleBtn.off(cc.Node.EventType.TOUCH_END,this._onTouchEnd,this),this.MissleBtn.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this)},e.prototype.start=function(){this.RefershUI(),this.InitMapPoint(),this.Finger1.active=!1,this.Finger2.active=!1,this.MissleBtn.active=!1,[1,2].includes(c.LocalDataManager.Instance.CurrentCheckpoint)&&(this.OpContainer.opacity=0)},e.prototype.SetFinger1Hide=function(){this.Finger1.active=!1},e.prototype.SetFinger2Hide=function(){this.Finger2.active=!1},e.prototype.InitMapPoint=function(){for(var t,e=0;e<this.MapContainer.childrenCount;e++)null===(t=this.MapContainer.children[e].getComponent(s.PlotItem))||void 0===t||t.InitData(e+1);this._getMapBrothersPlot=[]},e.prototype.RefershUI=function(){this.MainGK.string="\u5173\u5361 "+c.LocalDataManager.Instance.CurrentCheckpoint.toString(),this.MainCoin.string=c.LocalDataManager.Instance.MainCoin.toString(),this.PersonNum.string=c.LocalDataManager.Instance.GetPersonNum().toString(),this.PersonNumNeedCoin.string=c.LocalDataManager.Instance.GetUpdateLevelNeedCoin(a.EUpdateType.Person).toString(),this.PersonSpeedNum.string=c.LocalDataManager.Instance.PersonSpeed.toFixed(2),this.PersonSpeedNeedCoin.string=c.LocalDataManager.Instance.GetUpdateLevelNeedCoin(a.EUpdateType.PersonSpeed).toString(),this.BlBtn.interactable=c.LocalDataManager.Instance.CheckUpdateCoinEnough(a.EUpdateType.Person),this.BlSpeedBtn.interactable=c.LocalDataManager.Instance.CheckUpdateCoinEnough(a.EUpdateType.PersonSpeed)},e.prototype.checkSuccess=function(){for(var t=c.LocalDataManager.Instance.GetCurrentCheckpointConvertCheckPoint(),e=c.LocalDataManager.Instance.GameGlobalConfig.CheckPointMap,o=!0,n=!0,r=0;r<this.MapContainer.childrenCount;r++){var i=this.MapContainer.children[r];if(i.getComponent(s.PlotItem)){var a=i.getComponent(s.PlotItem).GetIndex();if(e.MapHash[t-1].includes(a)){var p=i.getComponent(s.PlotItem).GetUniqueAttributeIndex();p!==c.LocalDataManager.Instance.PlayerUniqueAttributeIndex?-1!==p&&(o=!1):n=!1}}}o&&(this.SuccessNode.active=!0,c.LocalDataManager.Instance.CurrentCheckpoint,c.LocalDataManager.Instance.CurrentCheckpoint=t,1===c.LocalDataManager.Instance.CurrentCheckpoint?c.LocalDataManager.Instance.MainCoin+=200:c.LocalDataManager.Instance.MainCoin+=160*(c.LocalDataManager.Instance.CurrentCheckpoint-1)+200,this.RefershUI(),this.StopBattle()),n&&(this.FaileNode.active=!0,c.LocalDataManager.Instance.MainCoin-=160*(c.LocalDataManager.Instance.CurrentCheckpoint-1)+200,c.LocalDataManager.Instance.MainCoin<0&&(c.LocalDataManager.Instance.MainCoin=0),this.RefershUI(),this.StopBattle())},e.prototype.CheckTouchRight=function(t,e){for(var o=0,n=this.GetMapBrothersPlot(e);o<n.length;o++){var r=n[o];if(r.getBoundingBoxToWorld().contains(cc.v2(t.x,t.y)))return r}},e.prototype.update=function(){!0!==this.GameStartBtn.active&&!0!==this.SuccessNode.active&&!0!==this.FaileNode.active&&this.checkSuccess()},e.prototype.OnClickContinueLevel=function(){for(var t,e,o=0;o<this.MapContainer.childrenCount;o++){var n=this.MapContainer.children[o];null===(t=n.getComponent(s.PlotItem))||void 0===t||t.RefreshInitData(),null===(e=n.getComponent(s.PlotItem))||void 0===e||e.StartBattle()}this.FaileNode.active=!1,this._getMapBrothersPlot.length=0},e.prototype.OnClickNextLevel=function(){var t;c.LocalDataManager.Instance.CurrentCheckpoint+=1;for(var e=0;e<this.MapContainer.childrenCount;e++)null===(t=this.MapContainer.children[e].getComponent(s.PlotItem))||void 0===t||t.RefreshInitData();this.SuccessNode.active=!1,this._getMapBrothersPlot.length=0,this.InGameOp()},e.prototype.OnClickGameBack=function(){console.log("\u6e38\u620f\u8fd4\u56de"),this.InOpMenu(),this.BGMask.node.active=!1},e.prototype.InGameOp=function(){var t=this,e=c.LocalDataManager.Instance.GetCurrentCheckpointConvertCheckPoint(),o=this._gameGlobalConfig.CarmeraOp,n=cc.tween;this.OpContainer.opacity=0,this.MissleBtn.opacity=0,n(this.MissleBtn).to(this.Speed,{opacity:255}).start(),n(this.MapContainer).parallel(n(this.MapContainer).to(this.Speed,{scale:o.MapScale[e-1]}),n(this.MapContainer).to(this.Speed,{position:cc.v3(o.MapPositions[e-1][0],o.MapPositions[e-1][1])})).call(function(){t.GameOpContainer.active=!0,1===c.LocalDataManager.Instance.CurrentCheckpoint?(t.Finger1.active=!0,t.Finger2.active=!1,t.BackBtn.active=!1):2===c.LocalDataManager.Instance.CurrentCheckpoint?(t.Finger2.active=!0,t.Finger1.active=!1,t.BackBtn.active=!1):t.BackBtn.active=!0,t.StartBattle()}).start()},e.prototype.StartBattle=function(){for(var t,e=0;e<this.MapContainer.childrenCount;e++)null===(t=this.MapContainer.children[e].getComponent(s.PlotItem))||void 0===t||t.StartBattle();this.BGMask.node.active=!0},e.prototype.StopBattle=function(){for(var t,e=0;e<this.MapContainer.childrenCount;e++)null===(t=this.MapContainer.children[e].getComponent(s.PlotItem))||void 0===t||t.StopBattle();this.BGMask.node.active=!1},e.prototype.InOpMenu=function(){for(var t,e,o=this,n=cc.tween,r=0;r<this.MapContainer.childrenCount;r++){var i=this.MapContainer.children[r];null===(t=i.getComponent(s.PlotItem))||void 0===t||t.RefreshInitData(),null===(e=i.getComponent(s.PlotItem))||void 0===e||e.StopBattle()}n(this.MissleBtn).to(this.Speed,{opacity:0}).start(),n(this.MapContainer).parallel(n(this.MapContainer).to(this.Speed,{scale:.5}),n(this.MapContainer).to(this.Speed,{position:cc.v3(-122.958,339.672)})).call(function(){o.GameOpContainer.active=!1,o.OpContainer.opacity=255,o.GameStartBtn.active=!0}).start()},e.prototype.OnClickGameStart=function(){var t,e=this;console.log("\u6e38\u620f\u5f00\u59cb"),this.GameStartBtn.active=!1;for(var o=0;o<this.MapContainer.childrenCount;o++)null===(t=this.MapContainer.children[o].getComponent(s.PlotItem))||void 0===t||t.RefreshInitData();1!==c.LocalDataManager.Instance.CurrentCheckpoint?(cc.tween(this.OpContainer).to(this.Speed,{opacity:0}).call(function(){e.InGameOp()}).start(),this.BGMask.node.active=!0):this.InGameOp()},e.prototype.OnClickUpdatePersonNum=function(){var t;if(0!==this.OpContainer.opacity)if(console.log("\u521d\u59cb\u4eba\u6570\u5347\u7ea7"),c.LocalDataManager.Instance.CheckUpdateCoinEnough(a.EUpdateType.Person)){console.log("\u53ef\u4ee5\u5347\u7ea7"),c.LocalDataManager.Instance.UpdatePersonNum(),this.RefershUI();for(var e=0;e<this.MapContainer.childrenCount;e++)null===(t=this.MapContainer.children[e].getComponent(s.PlotItem))||void 0===t||t.RefreshInitData()}else console.log("\u91d1\u5e01\u4e0d\u8db3")},e.prototype.OnClickUpdatePersonSpeed=function(){0!==this.OpContainer.opacity&&(console.log("\u5175\u529b\u589e\u901f"),c.LocalDataManager.Instance.CheckUpdateCoinEnough(a.EUpdateType.PersonSpeed)?(console.log("\u53ef\u4ee5\u5347\u7ea7"),c.LocalDataManager.Instance.UpdatePersonSpeedNum(),this.RefershUI()):console.log("\u91d1\u5e01\u4e0d\u8db3"))},i([h(cc.Label)],e.prototype,"MainCoin",void 0),i([h(cc.Sprite)],e.prototype,"BGMask",void 0),i([h(cc.Label)],e.prototype,"MainGK",void 0),i([h(cc.Label)],e.prototype,"PersonNum",void 0),i([h(cc.Label)],e.prototype,"PersonNumNeedCoin",void 0),i([h(cc.Label)],e.prototype,"PersonSpeedNum",void 0),i([h(cc.Label)],e.prototype,"PersonSpeedNeedCoin",void 0),i([h(cc.JsonAsset)],e.prototype,"GameConfig",void 0),i([h(cc.Node)],e.prototype,"MapContainer",void 0),i([h(cc.Node)],e.prototype,"OpContainer",void 0),i([h(cc.Node)],e.prototype,"GameOpContainer",void 0),i([h(cc.Button)],e.prototype,"BlBtn",void 0),i([h(cc.Button)],e.prototype,"BlSpeedBtn",void 0),i([h(cc.Node)],e.prototype,"GameStartBtn",void 0),i([h(cc.Node)],e.prototype,"SuccessNode",void 0),i([h(cc.Node)],e.prototype,"FaileNode",void 0),i([h(cc.Node)],e.prototype,"Finger1",void 0),i([h(cc.Node)],e.prototype,"Finger2",void 0),i([h(cc.Node)],e.prototype,"BackBtn",void 0),i([h(cc.Prefab)],e.prototype,"MombPrefab",void 0),i([h(cc.Node)],e.prototype,"MissleBtn",void 0),i([h(cc.Prefab)],e.prototype,"ArrowPrefab",void 0),i([h],e.prototype,"Speed",void 0),i([u],e)}(cc.Component);o.GamePlotMain=d,cc._RF.pop()},{"./GameConst":"GameConst","./LocalDataManager":"LocalDataManager","./PlotItem":"PlotItem","./Utils":"Utils"}],LocalDataManager:[function(t,e,o){"use strict";cc._RF.push(e,"9f135Q2T4FA66vfk35pjqmo","LocalDataManager");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.LocalDataManager=void 0;var i=t("./GameConst"),a=t("./Singleton"),c=t("./Utils"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerUniqueAttributeIndex=99999,e.currentPersonLv=1,e.currentPersonSpeedLv=1,e.mainCoin=0,e.personSpeed=1,e.currentCheckpoint=1,e}return r(e,t),Object.defineProperty(e,"Instance",{get:function(){return e.GetInstance(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"PlayerUniqueAttributeIndex",{get:function(){return this.playerUniqueAttributeIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CurrentPersonLv",{get:function(){return this.currentPersonLv},set:function(t){this.currentPersonLv=t,this.setSingleValue(i.EPLAYERDATA.CurrentPersonLv,this.currentPersonLv.toString())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CurrentPersonSpeedLv",{get:function(){return this.currentPersonSpeedLv},set:function(t){this.currentPersonSpeedLv=t,this.setSingleValue(i.EPLAYERDATA.CurrentPersonSpeedLv,this.currentPersonSpeedLv.toString())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MainCoin",{get:function(){return this.mainCoin},set:function(t){this.mainCoin=t,this.setSingleValue(i.EPLAYERDATA.MainCoin,this.mainCoin.toString())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"PersonSpeed",{get:function(){return this.personSpeed},set:function(t){this.personSpeed=t,this.setSingleValue(i.EPLAYERDATA.PersonSpeed,this.personSpeed.toString())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CurrentCheckpoint",{get:function(){return this.currentCheckpoint},set:function(t){this.currentCheckpoint=t,this.setSingleValue(i.EPLAYERDATA.CurrentCheckpoint,this.currentCheckpoint.toString())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CurrentShopXBItemName",{get:function(){return this.currentShopXBItemName},set:function(t){this.currentShopXBItemName=t,this.setSingleValue(i.EPLAYERDATA.CurrentShopXBItemName,this.currentShopXBItemName)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CurrentShopJDItemName",{get:function(){return this.currentShopJDItemName},set:function(t){this.currentShopJDItemName=t,this.setSingleValue(i.EPLAYERDATA.CurrentShopJDItemName,this.currentShopJDItemName)},enumerable:!1,configurable:!0}),e.prototype.Init=function(){this.currentCheckpoint=parseInt(e.Instance.getSingleValue(i.EPLAYERDATA.CurrentCheckpoint,!0)),this.mainCoin=parseInt(e.Instance.getSingleValue(i.EPLAYERDATA.MainCoin,!0)),this.personSpeed=parseFloat(e.Instance.getSingleValue(i.EPLAYERDATA.PersonSpeed,!0)),this.currentPersonLv=parseInt(e.Instance.getSingleValue(i.EPLAYERDATA.CurrentPersonLv,!0)),this.currentPersonSpeedLv=parseInt(e.Instance.getSingleValue(i.EPLAYERDATA.CurrentPersonSpeedLv,!0)),this.currentShopXBItemName=e.Instance.getSingleValue(i.EPLAYERDATA.CurrentShopXBItemName,!0),this.currentShopJDItemName=e.Instance.getSingleValue(i.EPLAYERDATA.CurrentShopJDItemName,!0),this.ShopItem=e.Instance.getObjectValue(i.EPLAYERDATA.Shop),e.Instance.SaveShopItem("bin"),e.Instance.SaveShopItem("bajie")},e.prototype.SaveShopItem=function(t){null===this.ShopItem&&(this.ShopItem=[]),this.ShopItem.includes(t)||(this.ShopItem.push(t),this.setObjectValue(i.EPLAYERDATA.Shop,this.ShopItem))},e.prototype.GetShopItem=function(){return this.ShopItem},e.prototype.setObjectValue=function(t,e,o){void 0===o&&(o=i.EnumLocalDataScope.BindUser);var n=JSON.stringify(e);this.setLocalStorage(t,n,o,!0)},e.prototype.getObjectValue=function(t,e){void 0===e&&(e=i.EnumLocalDataScope.BindUser);var o=this.getLocalStorage(t,e,!0);return o?JSON.parse(o):null},e.prototype.setSingleValue=function(t,e,o){void 0===o&&(o=i.EnumLocalDataScope.BindUser),this.setLocalStorage(t,e,o,!1)},e.prototype.getSingleValue=function(t,e,o){void 0===e&&(e=!1),void 0===o&&(o=i.EnumLocalDataScope.BindUser);var n=this.getLocalStorage(t,o,!1);if(!n){switch(t){case i.EPLAYERDATA.CurrentPersonLv:case i.EPLAYERDATA.CurrentPersonSpeedLv:case i.EPLAYERDATA.CurrentCheckpoint:case i.EPLAYERDATA.PersonSpeed:n="1";break;case i.EPLAYERDATA.MainCoin:n="0";break;case i.EPLAYERDATA.CurrentShopJDItemName:n="bajie";break;case i.EPLAYERDATA.CurrentShopXBItemName:n="bin"}e&&this.setLocalStorage(t,n,o,!1)}return console.log("getSingleValue: "+t+" \u503c\u4e3a: "+n),n},e.prototype.setLocalStorage=function(t,e,o,n){if(o==i.EnumLocalDataScope.BindUser){var r=localStorage.getItem("User_SCDJ"),a=r?JSON.parse(r):{};a[t]=n?JSON.parse(e):e,localStorage.setItem("User_SCDJ",JSON.stringify(a))}else o==i.EnumLocalDataScope.Share&&localStorage.setItem(t,e)},e.prototype.getLocalStorage=function(t,e,o){var n="";if(e==i.EnumLocalDataScope.BindUser){var r=localStorage.getItem("User_SCDJ"),a=r?JSON.parse(r):{};n=o?JSON.stringify(a[t]):a[t]}else e==i.EnumLocalDataScope.Share&&(n=localStorage.getItem(t));return n},e.prototype.GetEmptyPersonNum=function(){return this.CurrentCheckpoint<=10?this.GameGlobalConfig.PlotEmptyNum[this.CurrentCheckpoint-1]:10+10*Math.floor(this.CurrentCheckpoint/10)},e.prototype.GetHighLimitPersonNum=function(){return this.CurrentCheckpoint<=19?50:this.CurrentCheckpoint<=29?80:80+20*Math.floor(this.CurrentCheckpoint/10-2)},e.prototype.GetEnemyPersonNum=function(){if(this.CurrentCheckpoint<=5)return this.GameGlobalConfig.PlotEnemyNum[this.CurrentCheckpoint-1];if(6===this.CurrentCheckpoint){var t=c.Utils.RandomNum(0,1,!0);return this.GameGlobalConfig.PlotEnemy6MinPersonNum+c.Utils.GetRandomItemOfArray(0===t?[1,2,3,4,5]:[1,2,3,4,5,6])}return t=c.Utils.RandomNum(0,1,!0),this.GameGlobalConfig.PlotEnemy7MinPersonNum+(this.CurrentCheckpoint-7)+c.Utils.GetRandomItemOfArray(0===t?[1,2,3,4,5]:[1,2,3,4,5,6])},e.prototype.GetPersonNum=function(){return 1===this.CurrentCheckpoint||2===this.CurrentCheckpoint?this.GameGlobalConfig.GuidePersonNum[this.CurrentCheckpoint-1]:1===this.CurrentPersonLv?this.GameGlobalConfig.InItPersonNum:this.GameGlobalConfig.InItPersonNum+this.CurrentPersonLv-1},e.prototype.UpdatePersonSpeedNum=function(){var t=this.GetUpdateLevelNeedCoin(i.EUpdateType.PersonSpeed);this.MainCoin-=t,this.CurrentPersonSpeedLv+=1,this.PersonSpeed+=c.Utils.GetRandomItemOfArray(this.GameGlobalConfig.PersonSpeedNumIncrease)},e.prototype.UpdatePersonNum=function(){var t=this.GetUpdateLevelNeedCoin(i.EUpdateType.Person);this.MainCoin-=t,this.CurrentPersonLv+=1},e.prototype.CheckUpdateCoinEnough=function(t){return this.GetUpdateLevelNeedCoin(t)<=this.MainCoin},e.prototype.GetUpdateLevelNeedCoin=function(t){return t==i.EUpdateType.Person?1===this.CurrentPersonLv?this.GameGlobalConfig.InitLevelUpNeedCoin:(this.CurrentPersonLv-1)*this.GameGlobalConfig.LevelUpIncreaseCoin+this.GameGlobalConfig.InitLevelUpNeedCoin:1==this.CurrentPersonSpeedLv?this.GameGlobalConfig.InitLevelUpNeedCoin:(this.CurrentPersonSpeedLv-1)*this.GameGlobalConfig.LevelUpIncreaseCoin+this.GameGlobalConfig.InitLevelUpNeedCoin},e.prototype.GetCurrentcheckpointConvertCheckPoint2=function(t){return t<=10?t:t%10>0?t%10:10},e.prototype.GetCurrentCheckpointConvertCheckPoint=function(){return this.CurrentCheckpoint<=10?this.CurrentCheckpoint:this.CurrentCheckpoint%10>0?this.CurrentCheckpoint%10:10},e}(a.Singleton);o.LocalDataManager=s,cc._RF.pop()},{"./GameConst":"GameConst","./Singleton":"Singleton","./Utils":"Utils"}],MapManager:[function(t,e,o){"use strict";cc._RF.push(e,"5ef1cqRFvJAtIqofnSrFE7R","MapManager");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.MapManager=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e,"Instance",{get:function(){return e.GetInstance(e)},enumerable:!1,configurable:!0}),e}(t("./Singleton").Singleton);o.MapManager=i,cc._RF.pop()},{"./Singleton":"Singleton"}],PlotItem:[function(t,e,o){"use strict";cc._RF.push(e,"8880bkiXThEMbBwVUiLLFF1","PlotItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.PlotItem=void 0;var a=t("./Buttle"),c=t("./GamePlotMain"),s=t("./LocalDataManager"),p=t("./Utils"),l=cc._decorator,u=l.ccclass,h=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.PointMainCityItem=null,e.TargetMark=null,e.ButtlePrefab=null,e.ArrowPrefab=null,e._blockHouse=null,e._isPlayer=!1,e._guide1Step=!1,e._arrowNode=null,e}var o;return r(e,t),o=e,e.prototype.onLoad=function(){var t=cc.instantiate(this.PointMainCityItem);this.node.addChild(t),this._blockHouse=t.getComponent("BlockHouse"),this._isPlayer=!1,this._targetMark=null,t.on(cc.Node.EventType.TOUCH_START,this._onTouchStart,this),t.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),t.on(cc.Node.EventType.TOUCH_END,this._onTouchEnd,this),t.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this)},e.prototype.SetMyPlayer=function(){this._isPlayer=!0},e.prototype.GetUniqueAttributeIndex=function(){return this._blockHouse.UniqueAttributeIndex},e.prototype.GetBlockHouse=function(){return this._blockHouse},e.prototype.GetBlockHouseNode=function(){return this._blockHouse.node},e.prototype.GetIndex=function(){return this._index},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this)},e.prototype.SetStep1=function(){this._guide1Step=!0},e.prototype._onTouchCancel=function(t){if(this._isPlayer&&(this._arrowNode&&(this._arrowNode.destroy(),this._arrowNode=null),!(this._blockHouse.GetCurrentPerson()<=0))){console.log("_onTouchCancel ....");var e=t.getLocation(),n=this.node.parent.parent.getComponent(c.GamePlotMain).CheckTouchRight(e,this._index);if(n){if(this.node.name===n.parent.name)return;if(console.log("_onTouchCancel target name "+n.parent.name),1===s.LocalDataManager.Instance.CurrentCheckpoint&&"o1"!==n.parent.name)return;if(2===s.LocalDataManager.Instance.CurrentCheckpoint)if(this._guide1Step){if("o4"!==n.parent.name)return}else{if("o8"!==n.parent.name)return;n.parent.getComponent(o).SetStep1()}this.createButtle(n)}}},e.prototype.createButtle=function(t){var e=this;this._blockHouse.StartGrow();for(var o=this._blockHouse.GetCurrentPerson(),n=Math.floor(o/5),r=function(e){var n=cc.instantiate(i.ButtlePrefab);n.getComponent(a.Buttle).InitData(5,i.node.color),n.getComponent(a.Buttle).SetUniqueAttributeIndex(i._blockHouse.UniqueAttributeIndex,i._blockHouse.node.uuid,t),n.position=i.node.position,i.node.parent.addChild(n);var r=p.Utils.ConvertToNodeSpace(i.node.parent,t),c=p.Utils.GetAngle(i.node.position.x,i.node.position.y,r.x,r.y);console.log("angle: "+c),n.rotation=c,i._blockHouse.InitData(o-5*(e+1)),n.opacity=0,cc.tween(n).delay(.1*e).call(function(){n.opacity=255,n.getComponent(a.Buttle).SpreadOutButtle()}).to(1,{position:r},{progress:function(t,e,o,r){return r>.8&&n.getComponent(a.Buttle).CloseWithButtle(),t.lerp(e,r,o)}}).start()},i=this,c=0;c<n;c++)r(c);var s=o-5*n;if(s>0){var l=cc.instantiate(this.ButtlePrefab);l.getComponent(a.Buttle).InitData(s,this.node.color),l.getComponent(a.Buttle).SetUniqueAttributeIndex(this._blockHouse.UniqueAttributeIndex,this._blockHouse.node.uuid,t),l.position=this.node.position,this.node.parent.addChild(l),this._blockHouse.InitData(0);var u=p.Utils.ConvertToNodeSpace(this.node.parent,t),h=p.Utils.GetAngle(this.node.position.x,this.node.position.y,u.x,u.y);console.log("angle: "+h),l.rotation=h,l.opacity=0,cc.tween(l).delay(.1*n).call(function(){l.opacity=255,l.getComponent(a.Buttle).SpreadOutButtle()}).to(1,{position:u},{progress:function(t,e,o,n){return n>.8&&l.getComponent(a.Buttle).CloseWithButtle(),t.lerp(e,n,o)}}).call(function(){e._blockHouse.StartGrow()}).start()}else this.scheduleOnce(function(){e._blockHouse.StartGrow()},.1*n)},e.prototype._onTouchEnd=function(){this._isPlayer&&(console.log("_onTouchEnd ...."),this._arrowNode&&(this._arrowNode.destroy(),this._arrowNode=null))},e.prototype._onTouchMove=function(t){var e;if(this._isPlayer){var n=t.getLocation(),r=t.getStartLocation();null==this._arrowNode&&(this._arrowNode=cc.instantiate(this.ArrowPrefab),this.node.parent.parent.addChild(this._arrowNode),this._arrowNode.position=p.Utils.ConvertToNodeSpace(this.node.parent.parent,this._blockHouse.node));var i=n.sub(r).len();this._arrowNode.height=i;var a=p.Utils.GetAngle(r.x,r.y,n.x,n.y);if(this._arrowNode.rotation=a,!(this._blockHouse.GetCurrentPerson()<=0)){var l=this.node.parent.parent.getComponent(c.GamePlotMain).CheckTouchRight(n,this._index);if(l){if(this.node.name===l.parent.name)return;if(1===s.LocalDataManager.Instance.CurrentCheckpoint&&"o1"!==l.parent.name)return;if(2===s.LocalDataManager.Instance.CurrentCheckpoint)if(this._guide1Step){if("o4"!==l.parent.name)return}else if("o8"!==l.parent.name)return;null===(e=l.parent.getComponent(o))||void 0===e||e.SetTargetMark(),console.log("_onTouchMove target name "+l.name)}}}},e.prototype.RemoveTargeMark=function(){this._targetMark&&(this._targetMark.destroy(),this._targetMark=null)},e.prototype.SetTargetMark=function(){var t=cc.instantiate(this.TargetMark);this.node.parent.addChild(t),t.position=this.node.position,this._targetMark=t},e.prototype._onTouchStart=function(t){this._isPlayer&&(t.target,this._arrowNode&&(this._arrowNode.destroy(),this._arrowNode=null),console.log("_onTouchStart ...."),1===s.LocalDataManager.Instance.CurrentCheckpoint?this.node.parent.parent.getComponent(c.GamePlotMain).SetFinger1Hide():2===s.LocalDataManager.Instance.CurrentCheckpoint&&this.node.parent.parent.getComponent(c.GamePlotMain).SetFinger2Hide())},e.prototype.AutoAttack=function(t){var e,n,r=this.node.parent.parent.getComponent(c.GamePlotMain).GetMapBrothersPlot(this._index);if(t){for(var i=0,a=r;i<a.length;i++)if((h=a[i])!==this.node&&(null===(e=h.getComponent(o))||void 0===e?void 0:e.GetUniqueAttributeIndex())===this.GetUniqueAttributeIndex()){this.createButtle(h);break}}else{for(var s=[],l=0,u=r;l<u.length;l++){var h;if((h=u[l])!==this.node&&(null===(n=h.getComponent(o))||void 0===n?void 0:n.GetUniqueAttributeIndex())!==this.GetUniqueAttributeIndex()){s.push(h);break}}var d=p.Utils.GetRandomItemOfArray(s);this.createButtle(d)}},e.prototype.RefreshInitData=function(){this.InitData(this._index)},e.prototype.StartBattle=function(){var t=s.LocalDataManager.Instance.GetCurrentCheckpointConvertCheckPoint();s.LocalDataManager.Instance.GameGlobalConfig.CheckPointMap.MapHash[t-1].includes(this._index)&&-1!==this.GetUniqueAttributeIndex()&&this._blockHouse.StartGrow()},e.prototype.StopBattle=function(){var t=s.LocalDataManager.Instance.GetCurrentCheckpointConvertCheckPoint();s.LocalDataManager.Instance.GameGlobalConfig.CheckPointMap.MapHash[t-1].includes(this._index)&&this._blockHouse.StopGrowUp()},e.prototype.InitData=function(t){this._index=t;var e=s.LocalDataManager.Instance.GetCurrentCheckpointConvertCheckPoint(),o=s.LocalDataManager.Instance.GameGlobalConfig.CheckPointMap;if(e<=4)for(var n=0;n<o.MapHash.length;n++)n<e-1?o.MapHash[n].includes(this._index)&&(this.node.opacity=120,this.node.color=(new cc.Color).fromHEX(o.OwnColor),this._blockHouse.InitData(s.LocalDataManager.Instance.GetPersonNum()),this._blockHouse.UniqueAttributeIndex=-1):n<4&&o.MapHash[n].includes(this._index)&&(this.node.color=(new cc.Color).fromHEX("#FFFFFF"),this.node.opacity=120,this._blockHouse.InitData(s.LocalDataManager.Instance.GetEmptyPersonNum()));else if(e<=7)for(n=4;n<o.MapHash.length;n++)n<e-1?o.MapHash[n].includes(this._index)&&(this.node.opacity=120,this.node.color=(new cc.Color).fromHEX(o.OwnColor),this._blockHouse.InitData(s.LocalDataManager.Instance.GetPersonNum()),this._blockHouse.UniqueAttributeIndex=-1):n<7&&o.MapHash[n].includes(this._index)&&(this.node.color=(new cc.Color).fromHEX("#FFFFFF"),this.node.opacity=120,this._blockHouse.InitData(s.LocalDataManager.Instance.GetEmptyPersonNum()));else if(e<=10)for(n=7;n<o.MapHash.length;n++)n<e-1?o.MapHash[n].includes(this._index)&&(this.node.opacity=120,this.node.color=(new cc.Color).fromHEX(o.OwnColor),this._blockHouse.InitData(s.LocalDataManager.Instance.GetPersonNum()),this._blockHouse.UniqueAttributeIndex=-1):n<10&&o.MapHash[n].includes(this._index)&&(this.node.color=(new cc.Color).fromHEX("#FFFFFF"),this.node.opacity=120,this._blockHouse.InitData(s.LocalDataManager.Instance.GetEmptyPersonNum()));o.MapHash[e-1].includes(this._index)?(this.node.opacity=255,o.OwnPositions[e-1]==t?(this._isPlayer=!0,this.node.color=(new cc.Color).fromHEX(o.OwnColor),this._blockHouse.InitData(s.LocalDataManager.Instance.GetPersonNum()),this._blockHouse.UniqueAttributeIndex=s.LocalDataManager.Instance.PlayerUniqueAttributeIndex):o.EnemyPostions[e-1].includes(t)?(n=this.getEnemyPositionIndex(o.EnemyPostions[e-1],t),console.log("i====== "+n),this._blockHouse.InitData(s.LocalDataManager.Instance.GetEnemyPersonNum()),this.node.color=(new cc.Color).fromHEX(o.EnemyColor[e-1][n]),this._blockHouse.UniqueAttributeIndex=1e4*this._index):(this._blockHouse.InitData(s.LocalDataManager.Instance.GetEmptyPersonNum()),this._blockHouse.UniqueAttributeIndex=-1,this.node.color=(new cc.Color).fromHEX("#FFFFFF"))):(this.node.color=(new cc.Color).fromHEX("#FFFFFF"),this.node.opacity=50)},e.prototype.getEnemyPositionIndex=function(t,e){for(var o=0;o<t.length;o++)if(t[o]===e)return o;return 0},e.prototype.onCollisionEnter=function(t){console.log("other: "+t.node.name)},i([h(cc.Prefab)],e.prototype,"PointMainCityItem",void 0),i([h(cc.Prefab)],e.prototype,"TargetMark",void 0),i([h(cc.Prefab)],e.prototype,"ButtlePrefab",void 0),i([h(cc.Prefab)],e.prototype,"ArrowPrefab",void 0),o=i([u],e)}(cc.Component);o.PlotItem=d,cc._RF.pop()},{"./Buttle":"Buttle","./GamePlotMain":"GamePlotMain","./LocalDataManager":"LocalDataManager","./Utils":"Utils"}],ShopItem:[function(t,e,o){"use strict";cc._RF.push(e,"44e34qJYqBMV5kgtU4TZPDZ","ShopItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.ShopItem=void 0;var a=t("./LocalDataManager"),c=cc._decorator,s=c.ccclass,p=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.VideoNode=null,e.IconSprite=null,e.SelectSpriteFrame=null,e.NormalSpriteFrame=null,e.IconJDPrefab=null,e.IconXBPrefab=null,e}var o;return r(e,t),o=e,e.prototype.onLoad=function(){},e.prototype.onClickItem=function(){this.VideoNode.active||this.RefreshUI()},e.prototype.RefreshUI=function(){this._isJD?a.LocalDataManager.Instance.CurrentShopJDItemName=this._itemName:a.LocalDataManager.Instance.CurrentShopXBItemName=this._itemName;for(var t=0;t<this.node.parent.childrenCount;t++)this.node.parent.children[t].getComponent(o).InitSprite()},e.prototype.createShopIcon=function(){var t;this._shopIcon.removeAllChildren(),this._isJD?(t=cc.instantiate(this.IconJDPrefab),this._shopIcon.addChild(t),t.getComponent(sp.Skeleton).setSkin("binying/"+this._itemName),t.getComponent(sp.Skeleton).setAnimation(0,"animation",!0)):(t=cc.instantiate(this.IconXBPrefab),this._shopIcon.addChild(t),t.getComponent(sp.Skeleton).setSkin("bin/"+this._itemName),t.getComponent(sp.Skeleton).setAnimation(0,"animation",!0))},e.prototype.InitSprite=function(){this._isJD?a.LocalDataManager.Instance.CurrentShopJDItemName===this._itemName?(this.node.getComponent(cc.Sprite).spriteFrame=this.SelectSpriteFrame,this.createShopIcon()):this.node.getComponent(cc.Sprite).spriteFrame=this.NormalSpriteFrame:a.LocalDataManager.Instance.CurrentShopXBItemName===this._itemName?(this.node.getComponent(cc.Sprite).spriteFrame=this.SelectSpriteFrame,this.createShopIcon()):this.node.getComponent(cc.Sprite).spriteFrame=this.NormalSpriteFrame},e.prototype.InitData=function(t,e,o,n){void 0===o&&(o=!1),void 0===n&&(n=null),this._itemName=t,this._isJD=o,this._shopIcon=n,a.LocalDataManager.Instance.GetShopItem().includes(t)?this.VideoNode.active=!1:this.VideoNode.active=!0,this.IconSprite.spriteFrame=e,this.InitSprite()},i([p(cc.Node)],e.prototype,"VideoNode",void 0),i([p(cc.Sprite)],e.prototype,"IconSprite",void 0),i([p(cc.SpriteFrame)],e.prototype,"SelectSpriteFrame",void 0),i([p(cc.SpriteFrame)],e.prototype,"NormalSpriteFrame",void 0),i([p(cc.Prefab)],e.prototype,"IconJDPrefab",void 0),i([p(cc.Prefab)],e.prototype,"IconXBPrefab",void 0),o=i([s],e)}(cc.Component);o.ShopItem=l,cc._RF.pop()},{"./LocalDataManager":"LocalDataManager"}],Singleton:[function(t,e,o){"use strict";cc._RF.push(e,"20ced5hePZKp7Yyo9iCVrH5","Singleton"),Object.defineProperty(o,"__esModule",{value:!0}),o.Singleton=void 0;var n=function(){function t(){}return t.GetInstance=function(t){return null==this.instance&&(this.instance=new t),this.instance},t.instance=null,t}();o.Singleton=n,cc._RF.pop()},{}],Utils:[function(t,e,o){"use strict";cc._RF.push(e,"32afewLo3VAgZKGWNLhgYkh","Utils"),Object.defineProperty(o,"__esModule",{value:!0}),o.Utils=void 0;var n=function(){function t(){}return t.GetRandomItemOfArray=function(t){if(t instanceof Array)return t[this.RandomNum(0,t.length-1,!0)]},t.GetAngle=function(t,e,o,n){var r=cc.v2(t,e);return cc.v2(o,n).sub(r).signAngle(cc.v2(0,1))/Math.PI*180},t.ConvertToNodeSpace2=function(t,e){var o=e.parent.convertToWorldSpaceAR(e.position);return t.parent.convertToNodeSpaceAR(o)},t.ConvertToNodeSpace=function(t,e){var o=e.parent.convertToWorldSpaceAR(e.position);return t.convertToNodeSpaceAR(o)},t.RandomNum=function(t,e,o){void 0===o&&(o=!1);var n=Math.random()*(e-t)+t;if(o){var r=e-t+1;return Math.floor(Math.random()*r)+t}return n},t}();o.Utils=n,cc._RF.pop()},{}]},{},["BlockHouse","Buttle","ButtleItem","GameConst","GamePlotMain","LocalDataManager","MapManager","PlotItem","ShopItem","Singleton","Utils"]);